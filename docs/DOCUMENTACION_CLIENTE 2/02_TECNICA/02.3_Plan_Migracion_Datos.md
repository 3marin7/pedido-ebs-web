# ğŸ“¦ PLAN DE MIGRACIÃ“N DE DATOS
## Sistema de GestiÃ³n Comercial Distribuciones EBS

**Cliente:** [Nombre del Cliente]  
**Fecha de preparaciÃ³n:** 2 de febrero de 2026  
**Responsable tÃ©cnico:** Edwin MarÃ­n  
**VersiÃ³n:** 1.0  
**Estado:** Listo para aprobaciÃ³n

---

## ğŸ¯ OBJETIVO DE LA MIGRACIÃ“N

Transferir de manera segura y completa todos los datos histÃ³ricos del sistema actual (manual y/o existente) a la nueva plataforma EBS en Supabase, garantizando:

âœ… **Integridad:** 100% de los datos sin pÃ©rdidas ni corrupciÃ³n  
âœ… **Trazabilidad:** AuditorÃ­a completa del proceso  
âœ… **Disponibilidad:** MÃ­nima interrupciÃ³n operativa (mÃ¡x. 4 horas)  
âœ… **ValidaciÃ³n:** VerificaciÃ³n automÃ¡tica de consistencia  
âœ… **Rollback:** Capacidad de revertir en caso de problemas

---

## ğŸ“Š ANÃLISIS DE DATOS EXISTENTES

### 1. Inventario de Datos a Migrar

| Entidad | Registros Estimados | Formato Origen | Prioridad | Estado |
|---------|---------------------|----------------|-----------|---------|
| **Productos** | 150-200 | Excel/Papel | ğŸ”´ CrÃ­tica | âœ… Planificado |
| **Clientes** | 80-100 | Excel/Papel | ğŸ”´ CrÃ­tica | âœ… Planificado |
| **Facturas histÃ³ricas** | 300-500 | Papel | ğŸŸ¡ Alta | âœ… Planificado |
| **Inventario actual** | 150-200 | Excel/FÃ­sico | ğŸ”´ CrÃ­tica | âœ… Planificado |
| **Cuentas por cobrar** | 50-100 | Papel/Excel | ğŸ”´ CrÃ­tica | âœ… Planificado |
| **Abonos de clientes** | 100-200 | Papel | ğŸŸ¢ Media | âœ… Planificado |

**Total estimado:** ~1,500 registros histÃ³ricos

---

### 2. Estructura de Base de Datos Destino

#### Tablas Principales en Supabase

```sql
ğŸ“¦ productos
   â”œâ”€â”€ id (BIGINT, PK)
   â”œâ”€â”€ codigo (VARCHAR)
   â”œâ”€â”€ nombre (VARCHAR, REQUIRED)
   â”œâ”€â”€ precio (NUMERIC, REQUIRED)
   â”œâ”€â”€ stock (INTEGER, DEFAULT 0)
   â”œâ”€â”€ categoria_id (BIGINT, FK)
   â”œâ”€â”€ imagen_url (TEXT)
   â”œâ”€â”€ activo (BOOLEAN, DEFAULT true)
   â””â”€â”€ created_at (TIMESTAMP)

ğŸ‘¥ clientes
   â”œâ”€â”€ id (BIGINT, PK)
   â”œâ”€â”€ nombre (VARCHAR, REQUIRED)
   â”œâ”€â”€ direccion (VARCHAR)
   â”œâ”€â”€ telefono (VARCHAR)
   â”œâ”€â”€ correo (VARCHAR)
   â”œâ”€â”€ clasificacion (INTEGER, 1-5)
   â””â”€â”€ fecha_registro (TIMESTAMP)

ğŸ“„ facturas
   â”œâ”€â”€ id (BIGINT, PK)
   â”œâ”€â”€ cliente (VARCHAR, REQUIRED)
   â”œâ”€â”€ fecha (DATE, REQUIRED)
   â”œâ”€â”€ vendedor (VARCHAR)
   â”œâ”€â”€ direccion (VARCHAR)
   â”œâ”€â”€ telefono (VARCHAR)
   â”œâ”€â”€ correo (VARCHAR)
   â”œâ”€â”€ total (NUMERIC, REQUIRED)
   â”œâ”€â”€ productos (JSONB)
   â””â”€â”€ vendedor_id (BIGINT, FK)

ğŸ’° abonos
   â”œâ”€â”€ id (BIGINT, PK)
   â”œâ”€â”€ factura_id (BIGINT, FK)
   â”œâ”€â”€ monto (NUMERIC, REQUIRED)
   â”œâ”€â”€ fecha (TIMESTAMP)
   â”œâ”€â”€ metodo_pago (VARCHAR)
   â””â”€â”€ usuario (VARCHAR)

ğŸ“¦ movimientos_inventario
   â”œâ”€â”€ id (BIGINT, PK)
   â”œâ”€â”€ producto_id (BIGINT, FK)
   â”œâ”€â”€ tipo_movimiento (VARCHAR)
   â”œâ”€â”€ cantidad (INTEGER)
   â”œâ”€â”€ stock_anterior (INTEGER)
   â”œâ”€â”€ stock_nuevo (INTEGER)
   â”œâ”€â”€ factura_id (BIGINT, FK)
   â”œâ”€â”€ descripcion (TEXT)
   â””â”€â”€ fecha_movimiento (TIMESTAMP)
```

---

## ğŸ› ï¸ ESTRATEGIA DE MIGRACIÃ“N

### Enfoque: **MigraciÃ³n Big Bang Controlada**

**JustificaciÃ³n:**
- Volumen de datos manejable (~1,500 registros)
- Permite validaciÃ³n completa antes del go-live
- Minimiza sincronizaciÃ³n dual
- Menor riesgo de inconsistencias

**Alternativa rechazada:** MigraciÃ³n incremental (innecesaria para este volumen)

---

## ğŸ“‹ FASES DEL PLAN DE MIGRACIÃ“N

### **FASE 0: PREPARACIÃ“N** (Semana 1-2)

#### 0.1 RecopilaciÃ³n de Datos Origen
**DuraciÃ³n:** 3 dÃ­as  
**Responsable:** Cliente + Edwin MarÃ­n

**Actividades:**
- [ ] Solicitar archivos Excel de productos (si existen)
- [ ] Solicitar archivos Excel de clientes (si existen)
- [ ] Recopilar facturas fÃ­sicas de Ãºltimos 12 meses
- [ ] Documentar inventario fÃ­sico actual
- [ ] Identificar facturas pendientes de cobro
- [ ] Obtener listado de abonos realizados

**Entregables:**
```
ğŸ“ Datos_Origen/
   â”œâ”€â”€ productos.xlsx (o PDF/fotos)
   â”œâ”€â”€ clientes.xlsx (o PDF/fotos)
   â”œâ”€â”€ facturas_2025/ (carpeta con fotos/PDFs)
   â”œâ”€â”€ inventario_fisico.xlsx
   â””â”€â”€ cuentas_cobrar.xlsx
```

---

#### 0.2 AnÃ¡lisis y NormalizaciÃ³n
**DuraciÃ³n:** 2 dÃ­as  
**Responsable:** Edwin MarÃ­n

**Actividades:**
- [ ] Analizar calidad de datos origen
- [ ] Identificar duplicados en productos y clientes
- [ ] Normalizar formatos (precios, fechas, telÃ©fonos)
- [ ] Crear mapeo de datos: Origen â†’ Destino
- [ ] Generar plantillas Excel estÃ¡ndar si faltan datos estructurados

**Criterios de Calidad:**
| Campo | ValidaciÃ³n |
|-------|------------|
| Nombres | CapitalizaciÃ³n correcta, sin espacios extra |
| Precios | Formato numÃ©rico, sin sÃ­mbolos |
| TelÃ©fonos | Formato +57XXXXXXXXXX |
| Fechas | Formato ISO 8601 (YYYY-MM-DD) |
| Stocks | Enteros positivos |

---

#### 0.3 ConfiguraciÃ³n de Ambiente de MigraciÃ³n
**DuraciÃ³n:** 1 dÃ­a  
**Responsable:** Edwin MarÃ­n

**Actividades:**
- [ ] Crear base de datos de **staging** en Supabase
- [ ] Ejecutar scripts SQL para crear tablas
- [ ] Configurar polÃ­ticas RLS (Row Level Security)
- [ ] Preparar scripts de migraciÃ³n Python/Node.js
- [ ] Configurar herramientas de backup

**Scripts SQL a ejecutar:**
```sql
-- Orden de ejecuciÃ³n
1. ../../../sql/SQL_CREAR_TABLA_MOVIMIENTOS.sql
2. ../../../sql/AUDITORIA_PRODUCTOS_SETUP.sql
3. ../../../sql/EJECUTAR_ESTO_EN_SUPABASE.sql
4. ../../../sql/AGREGAR_DIRECCION_PEDIDOS.sql
```

---

### **FASE 1: MIGRACIÃ“N DE DATOS MAESTROS** (Semana 3)

#### 1.1 MigraciÃ³n de Productos
**DuraciÃ³n:** 1 dÃ­a  
**Prioridad:** ğŸ”´ CRÃTICA (sin productos no hay sistema)

**Proceso:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Excel/Fotos     â”‚
â”‚ de productos    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NormalizaciÃ³n   â”‚
â”‚ - Precios       â”‚
â”‚ - CÃ³digos       â”‚
â”‚ - Nombres       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ValidaciÃ³n      â”‚
â”‚ - Duplicados    â”‚
â”‚ - Campos req.   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Carga a         â”‚
â”‚ tabla productos â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VerificaciÃ³n    â”‚
â”‚ 100% cargados   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Script de carga:**
```javascript
// PseudocÃ³digo del proceso
async function migrarProductos(archivoExcel) {
  const productos = leerExcel(archivoExcel);
  
  for (const producto of productos) {
    // Validar datos
    if (!producto.nombre || !producto.precio) {
      throw new Error(`Producto invÃ¡lido: ${producto}`);
    }
    
    // Normalizar
    producto.nombre = normalizarTexto(producto.nombre);
    producto.precio = parseFloat(producto.precio);
    producto.stock = parseInt(producto.stock) || 0;
    
    // Insertar en Supabase
    await supabase.from('productos').insert(producto);
  }
  
  console.log(`âœ… ${productos.length} productos migrados`);
}
```

**Validaciones post-carga:**
- [ ] Verificar conteo: registros origen = registros destino
- [ ] Verificar precios: sin valores negativos o nulos
- [ ] Verificar stocks: sin valores negativos
- [ ] Verificar imÃ¡genes: URLs vÃ¡lidas (si aplica)

---

#### 1.2 MigraciÃ³n de Clientes
**DuraciÃ³n:** 1 dÃ­a  
**Prioridad:** ğŸ”´ CRÃTICA

**Proceso similar a productos:**

**Consideraciones especiales:**
- Eliminar duplicados (mismo nombre + telÃ©fono)
- Asignar clasificaciÃ³n inicial: nivel 3 (estÃ¡ndar)
- Crear fecha_registro retroactiva si no existe

**Script de validaciÃ³n:**
```sql
-- Verificar clientes duplicados
SELECT nombre, telefono, COUNT(*) 
FROM clientes 
GROUP BY nombre, telefono 
HAVING COUNT(*) > 1;

-- Verificar datos completos
SELECT COUNT(*) as sin_telefono 
FROM clientes 
WHERE telefono IS NULL OR telefono = '';
```

**Validaciones post-carga:**
- [ ] Verificar conteo total
- [ ] Verificar 0 duplicados por nombre+telÃ©fono
- [ ] Verificar clasificaciÃ³n entre 1-5
- [ ] Verificar formato de telÃ©fonos

---

### **FASE 2: MIGRACIÃ“N DE DATOS TRANSACCIONALES** (Semana 3-4)

#### 2.1 MigraciÃ³n de Facturas HistÃ³ricas
**DuraciÃ³n:** 2-3 dÃ­as  
**Prioridad:** ğŸŸ¡ ALTA  
**Complejidad:** Media-Alta

**Proceso:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Facturas fÃ­sicas/   â”‚
â”‚ Excel Ãºltimos 12m   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DigitalizaciÃ³n      â”‚
â”‚ (si son papel)      â”‚
â”‚ - Escanear/Foto     â”‚
â”‚ - ExtracciÃ³n datos  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EstructuraciÃ³n      â”‚
â”‚ - Cliente           â”‚
â”‚ - Fecha             â”‚
â”‚ - Productos (JSONB) â”‚
â”‚ - Total             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ValidaciÃ³n cruzada  â”‚
â”‚ - Cliente existe?   â”‚
â”‚ - Productos existen?â”‚
â”‚ - CÃ¡lculos OK?      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Carga a facturas    â”‚
â”‚ (sin afectar stock) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VerificaciÃ³n final  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš ï¸ IMPORTANTE:** Las facturas histÃ³ricas **NO actualizarÃ¡n** el inventario actual. Solo son para consulta y anÃ¡lisis.

**Estructura de factura migrada:**
```json
{
  "cliente": "MARTHA BLANCO",
  "fecha": "2025-06-15",
  "vendedor": "Edwin Marin",
  "direccion": "SABANA",
  "telefono": "3001234555",
  "total": 150000,
  "productos": [
    {
      "id": 3,
      "nombre": "TOALLAS NOSOTRAS RAPIGEL X 30",
      "precio": 11000,
      "cantidad": 10,
      "producto_id": 3
    }
  ],
  "created_at": "2025-06-15T10:00:00Z"
}
```

**Validaciones:**
- [ ] Total factura = suma(precio Ã— cantidad)
- [ ] Todos los clientes existen en tabla clientes
- [ ] Todos los producto_id existen en tabla productos
- [ ] Fechas en rango vÃ¡lido (Ãºltimos 24 meses)
- [ ] No hay duplicados de nÃºmero de factura

---

#### 2.2 MigraciÃ³n de Abonos
**DuraciÃ³n:** 1 dÃ­a  
**Prioridad:** ğŸŸ¢ MEDIA

**Proceso:**
```sql
-- Ejemplo de inserciÃ³n de abono
INSERT INTO abonos (factura_id, monto, fecha, metodo_pago, usuario)
VALUES (123, 50000, '2025-07-20', 'efectivo', 'Edwin Marin');
```

**Validaciones:**
- [ ] Cada abono tiene factura_id vÃ¡lido
- [ ] Suma de abonos â‰¤ total de factura
- [ ] Fechas de abonos â‰¥ fecha de factura
- [ ] Montos positivos

---

#### 2.3 Ajuste de Inventario Actual
**DuraciÃ³n:** 1 dÃ­a  
**Prioridad:** ğŸ”´ CRÃTICA

**Este es el stock REAL actual en bodega fÃ­sica.**

**Proceso:**
1. Hacer conteo fÃ­sico completo de inventario
2. Comparar con stock en tabla `productos`
3. Ajustar diferencias mediante movimientos de inventario

**Script de ajuste:**
```javascript
async function ajustarInventario(productoId, stockFisico, motivo) {
  // Obtener stock actual en sistema
  const { data: producto } = await supabase
    .from('productos')
    .select('stock')
    .eq('id', productoId)
    .single();
  
  const diferencia = stockFisico - producto.stock;
  
  if (diferencia !== 0) {
    // Registrar movimiento de ajuste
    await supabase.from('movimientos_inventario').insert({
      producto_id: productoId,
      tipo_movimiento: 'ajuste',
      cantidad: Math.abs(diferencia),
      stock_anterior: producto.stock,
      stock_nuevo: stockFisico,
      descripcion: `Ajuste inicial: ${motivo}`,
      usuario: 'Sistema - MigraciÃ³n',
      fecha_movimiento: new Date().toISOString()
    });
    
    // Actualizar stock en productos
    await supabase
      .from('productos')
      .update({ stock: stockFisico })
      .eq('id', productoId);
    
    console.log(`âœ… Stock ajustado: ${producto.stock} â†’ ${stockFisico}`);
  }
}
```

**Validaciones:**
- [ ] Todos los productos tienen stock â‰¥ 0
- [ ] Todos los ajustes estÃ¡n registrados en movimientos_inventario
- [ ] Stock fÃ­sico = stock en sistema

---

### **FASE 3: VALIDACIÃ“N Y VERIFICACIÃ“N** (Semana 4)

#### 3.1 ValidaciÃ³n de Integridad Referencial
**DuraciÃ³n:** 1 dÃ­a

**Consultas de validaciÃ³n:**

```sql
-- 1. Verificar facturas con clientes inexistentes
SELECT f.id, f.cliente 
FROM facturas f
LEFT JOIN clientes c ON f.cliente = c.nombre
WHERE c.id IS NULL;
-- Resultado esperado: 0 registros

-- 2. Verificar productos en facturas que no existen
SELECT DISTINCT 
  p->>'producto_id' as producto_id,
  p->>'nombre' as nombre_producto
FROM facturas, 
     jsonb_array_elements(facturas.productos) p
WHERE NOT EXISTS (
  SELECT 1 FROM productos 
  WHERE id = (p->>'producto_id')::bigint
);
-- Resultado esperado: 0 registros

-- 3. Verificar abonos con facturas inexistentes
SELECT a.id, a.factura_id 
FROM abonos a
LEFT JOIN facturas f ON a.factura_id = f.id
WHERE f.id IS NULL;
-- Resultado esperado: 0 registros

-- 4. Verificar sumas de abonos vs total factura
SELECT 
  f.id,
  f.total,
  COALESCE(SUM(a.monto), 0) as total_abonado,
  f.total - COALESCE(SUM(a.monto), 0) as saldo
FROM facturas f
LEFT JOIN abonos a ON f.id = a.factura_id
GROUP BY f.id
HAVING SUM(a.monto) > f.total;
-- Resultado esperado: 0 registros (no hay sobreabonos)
```

---

#### 3.2 ValidaciÃ³n de Calidad de Datos
**DuraciÃ³n:** 1 dÃ­a

**Checklist de calidad:**

| ValidaciÃ³n | Query | Esperado |
|------------|-------|----------|
| Productos sin precio | `SELECT COUNT(*) FROM productos WHERE precio IS NULL OR precio <= 0` | 0 |
| Productos sin nombre | `SELECT COUNT(*) FROM productos WHERE nombre IS NULL OR nombre = ''` | 0 |
| Clientes sin nombre | `SELECT COUNT(*) FROM clientes WHERE nombre IS NULL OR nombre = ''` | 0 |
| Facturas sin total | `SELECT COUNT(*) FROM facturas WHERE total IS NULL OR total <= 0` | 0 |
| Facturas sin fecha | `SELECT COUNT(*) FROM facturas WHERE fecha IS NULL` | 0 |
| Movimientos sin producto | `SELECT COUNT(*) FROM movimientos_inventario WHERE producto_id IS NULL` | 0 |

---

#### 3.3 Pruebas de Usuario AceptaciÃ³n (UAT)
**DuraciÃ³n:** 2 dÃ­as

**Casos de prueba:**

1. **Consulta de productos**
   - [ ] Buscar producto "TOALLAS NOSOTRAS"
   - [ ] Verificar precio y stock correcto
   - [ ] Verificar imagen carga correctamente

2. **Consulta de clientes**
   - [ ] Buscar cliente "MARTHA BLANCO"
   - [ ] Verificar datos de contacto
   - [ ] Verificar facturas histÃ³ricas del cliente

3. **Consulta de facturas**
   - [ ] Buscar facturas de agosto 2025
   - [ ] Verificar cÃ¡lculos correctos
   - [ ] Verificar productos en factura

4. **Crear factura nueva**
   - [ ] Crear factura con 3 productos
   - [ ] Verificar que stock se descuente
   - [ ] Verificar que se registre en movimientos_inventario

5. **Registrar abono**
   - [ ] Registrar abono de $50,000
   - [ ] Verificar que saldo se actualice
   - [ ] Verificar en historial de abonos

**Criterio de aceptaciÃ³n:** 100% de pruebas exitosas

---

### **FASE 4: GO-LIVE Y CUTOVER** (Inicio Semana 5)

#### 4.1 PreparaciÃ³n Final
**DuraciÃ³n:** 1 dÃ­a (previo al go-live)

**Actividades:**
- [ ] Backup completo de base de datos de staging
- [ ] Notificar a usuarios sobre fecha/hora de migraciÃ³n
- [ ] Preparar scripts de rollback
- [ ] Verificar accesos de usuarios
- [ ] Documentar estado actual del sistema

**Comunicado a usuarios:**
```
ğŸš€ MIGRACIÃ“N PROGRAMADA
Fecha: [DD/MM/YYYY]
Hora: 7:00 PM - 11:00 PM
Impacto: Sistema NO disponible (4 horas)
Alternativa: Registrar ventas en papel temporalmente
Contacto: Edwin MarÃ­n - +57 XXX XXX XXXX
```

---

#### 4.2 Cutover (DÃ­a D)
**DuraciÃ³n:** 4 horas (fuera de horario laboral)  
**Ventana:** 7:00 PM - 11:00 PM

**Timeline del cutover:**

```
19:00 â”‚ INICIO
      â”œâ”€ Backup final de sistema antiguo
      â””â”€ Poner sistema en modo mantenimiento
      
19:30 â”‚ MIGRACIÃ“N FINAL
      â”œâ”€ Sincronizar Ãºltimas facturas del dÃ­a
      â”œâ”€ Actualizar stocks finales
      â””â”€ Verificar conteos
      
20:30 â”‚ VALIDACIÃ“N
      â”œâ”€ Ejecutar queries de validaciÃ³n
      â”œâ”€ Pruebas de humo (smoke tests)
      â””â”€ Verificar con usuario clave
      
21:30 â”‚ GO-LIVE
      â”œâ”€ Activar sistema nuevo
      â”œâ”€ Probar operaciones crÃ­ticas
      â””â”€ Confirmar accesos de usuarios
      
22:00 â”‚ MONITOREO
      â”œâ”€ Vigilar primeras transacciones
      â”œâ”€ Soporte stand-by
      â””â”€ Documentar incidencias
      
23:00 â”‚ CIERRE
      â””â”€ Declarar GO-LIVE exitoso
```

---

#### 4.3 Plan de Rollback (si falla)
**Tiempo mÃ¡ximo de decisiÃ³n:** 2 horas despuÃ©s del inicio

**Condiciones de rollback:**
- PÃ©rdida de datos > 1%
- Errores crÃ­ticos en operaciones bÃ¡sicas
- Imposibilidad de generar facturas
- Problemas de acceso para usuarios clave

**Procedimiento de rollback:**
```bash
# 1. Detener aplicaciÃ³n nueva
systemctl stop ebs-app

# 2. Restaurar backup de staging
psql -U postgres -d ebs_staging < backup_pre_cutover.sql

# 3. Reactivar sistema antiguo
# (mantener registros en papel hasta resolver)

# 4. Notificar a usuarios
# "MigraciÃ³n pospuesta. Sistema original activo."

# 5. Analizar causa raÃ­z
# (revisiÃ³n tÃ©cnica post-mortem)
```

---

### **FASE 5: ESTABILIZACIÃ“N Y SOPORTE** (Semana 5-6)

#### 5.1 Monitoreo Post Go-Live
**DuraciÃ³n:** Primera semana

**MÃ©tricas a monitorear:**
- Tiempo de respuesta del sistema
- Errores en logs
- Quejas de usuarios
- Consultas de soporte

**Dashboard de monitoreo:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SISTEMA EBS - MONITOREO POST-MIGRACIÃ“Nâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Uptime:              99.8%             â”‚
â”‚ Facturas creadas:    45 (dÃ­a 1)        â”‚
â”‚ Errores crÃ­ticos:    0                 â”‚
â”‚ Tickets soporte:     3 (consultas)     â”‚
â”‚ Usuarios activos:    4/4               â”‚
â”‚ Ãšltima actualizaciÃ³n: 10:35 AM         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 5.2 Ajustes y Correcciones
**DuraciÃ³n:** 1-2 semanas

**Issues comunes esperados:**
| Tipo | Ejemplo | SoluciÃ³n |
|------|---------|----------|
| Usabilidad | "No encuentro botÃ³n X" | Tutorial + mejora UI |
| Datos | "Precio de producto Y incorrecto" | CorrecciÃ³n manual |
| Performance | "Sistema lento al buscar" | OptimizaciÃ³n query |
| CapacitaciÃ³n | "Â¿CÃ³mo genero reporte?" | SesiÃ³n de refuerzo |

---

#### 5.3 CapacitaciÃ³n de Refuerzo
**DuraciÃ³n:** 2 sesiones Ã— 2 horas

**Temas:**
- Operaciones diarias con datos reales
- ResoluciÃ³n de problemas comunes
- Mejores prÃ¡cticas
- Tips y atajos

---

## ğŸ›¡ï¸ PLAN DE CONTINGENCIA Y RIESGOS

### Matriz de Riesgos

| Riesgo | Probabilidad | Impacto | MitigaciÃ³n | Plan B |
|--------|--------------|---------|------------|--------|
| **Datos origen incompletos** | ğŸŸ¡ Media | ğŸ”´ Alto | ValidaciÃ³n temprana en Fase 0 | Completar manualmente con cliente |
| **CorrupciÃ³n durante carga** | ğŸŸ¢ Baja | ğŸ”´ Alto | Backups antes de cada carga | Restaurar desde backup + reintentar |
| **Usuarios no capacitados** | ğŸŸ¡ Media | ğŸŸ¡ Medio | CapacitaciÃ³n + manuales | Soporte extendido primera semana |
| **PÃ©rdida de facturas fÃ­sicas** | ğŸŸ¢ Baja | ğŸ”´ Alto | Digitalizar/fotografiar al recibir | Aceptar missing data (documentado) |
| **Downtime prolongado** | ğŸŸ¢ Baja | ğŸŸ¡ Medio | Cutover en horario no laboral | Rollback + reprogramar |
| **Resistencia al cambio** | ğŸŸ¡ Media | ğŸŸ¡ Medio | GestiÃ³n del cambio + involucrar usuarios | AcompaÃ±amiento personalizado |

---

### Estrategia de Backups

**Frecuencia durante migraciÃ³n:**
```
Fase 0: Diario (staging)
Fase 1: Antes/despuÃ©s de cada tabla migrada
Fase 2: Cada 4 horas durante carga transaccional
Fase 3: Diario
Fase 4: Cada hora durante cutover
Fase 5: Diario (primera semana) â†’ Semanal (normal)
```

**Tipos de backup:**
1. **Backup completo:** Base de datos completa
2. **Backup incremental:** Solo cambios desde Ãºltimo backup
3. **Backup de aplicaciÃ³n:** CÃ³digo y configuraciÃ³n

**RetenciÃ³n:**
- Backups durante migraciÃ³n: 30 dÃ­as
- Backups post go-live: 90 dÃ­as
- Backup pre-cutover: 1 aÃ±o (referencia)

---

## ğŸ“Š CRITERIOS DE Ã‰XITO

### Indicadores Clave (KPIs)

| KPI | Meta | MediciÃ³n |
|-----|------|----------|
| **Completitud de datos** | 100% de registros crÃ­ticos | Conteo origen vs destino |
| **Integridad referencial** | 0 errores de FK | Queries de validaciÃ³n |
| **PrecisiÃ³n de datos** | >99% datos correctos | Muestreo 10% + validaciÃ³n usuario |
| **Disponibilidad** | <4 horas downtime | Log de sistema |
| **SatisfacciÃ³n usuario** | >4/5 estrellas | Encuesta post go-live |
| **Errores post go-live** | <5 errores crÃ­ticos/semana | Log de incidencias |

---

### Criterios de AceptaciÃ³n Final

âœ… **MigraciÃ³n exitosa si:**
- [ ] 100% de productos migrados y validados
- [ ] 100% de clientes migrados sin duplicados
- [ ] >95% de facturas histÃ³ricas migradas
- [ ] 100% de inventario actual ajustado y correcto
- [ ] 0 errores de integridad referencial
- [ ] Sistema operativo y accesible
- [ ] Usuarios capacitados y conformes
- [ ] DocumentaciÃ³n completa entregada

---

## ğŸ“… CRONOGRAMA CONSOLIDADO

```
SEMANA 1-2: PREPARACIÃ“N
â”œâ”€ Lun-Mie: RecopilaciÃ³n datos origen
â”œâ”€ Jue-Vie: AnÃ¡lisis y normalizaciÃ³n
â””â”€ Sab: ConfiguraciÃ³n ambiente staging

SEMANA 3: MIGRACIÃ“N MAESTROS + TRANSACCIONALES
â”œâ”€ Lun: MigraciÃ³n productos
â”œâ”€ Mar: MigraciÃ³n clientes
â”œâ”€ Mie-Jue: MigraciÃ³n facturas histÃ³ricas
â””â”€ Vie: MigraciÃ³n abonos + ajuste inventario

SEMANA 4: VALIDACIÃ“N
â”œâ”€ Lun: ValidaciÃ³n integridad + calidad
â”œâ”€ Mar-Mie: UAT con usuarios
â”œâ”€ Jue: Correcciones finales
â””â”€ Vie: PreparaciÃ³n go-live

SEMANA 5: GO-LIVE
â”œâ”€ [DÃ­a D] 19:00-23:00: Cutover
â”œâ”€ Lun-Vie: Monitoreo intensivo
â””â”€ Vie: RevisiÃ³n post go-live

SEMANA 6: ESTABILIZACIÃ“N
â”œâ”€ Lun-Mie: Correcciones y ajustes
â”œâ”€ Jue: CapacitaciÃ³n de refuerzo
â””â”€ Vie: Cierre formal del proyecto
```

**DuraciÃ³n total:** 6 semanas  
**Esfuerzo estimado:** 120 horas tÃ©cnicas + 20 horas cliente

---

## ğŸ‘¥ ROLES Y RESPONSABILIDADES

| Rol | Responsable | Responsabilidades | Disponibilidad |
|-----|-------------|-------------------|----------------|
| **LÃ­der tÃ©cnico** | Edwin MarÃ­n | EjecuciÃ³n migraciÃ³n, scripts, validaciÃ³n | 100% dedicaciÃ³n |
| **Usuario clave** | [Nombre] | ValidaciÃ³n datos, UAT, decisiones negocio | 40% dedicaciÃ³n |
| **Gerente/DueÃ±o** | [Nombre] | Aprobaciones, comunicaciÃ³n, rollback | Disponible on-call |
| **Soporte** | Edwin MarÃ­n | AtenciÃ³n incidencias post go-live | 24/7 primera semana |

---

## ğŸ“ CANALES DE COMUNICACIÃ“N

**Durante migraciÃ³n activa (Semana 3-5):**
- **Whatsapp:** Incidencias urgentes (+57 XXX XXX XXXX)
- **Email:** Reportes diarios (3marin7@gmail.com)
- **ReuniÃ³n diaria:** 6:00 PM (15 min standup)

**Post go-live:**
- **Whatsapp:** Soporte normal
- **Email:** Consultas no urgentes
- **ReuniÃ³n semanal:** Estado del sistema

---

## ğŸ“„ ENTREGABLES FINALES

Al completar la migraciÃ³n, se entregarÃ¡n:

- [ ] âœ… Base de datos migrada y operativa
- [ ] âœ… Informe de migraciÃ³n con estadÃ­sticas
- [ ] âœ… Scripts de migraciÃ³n (documentados)
- [ ] âœ… Backups completos (pre y post migraciÃ³n)
- [ ] âœ… Matriz de validaciÃ³n de datos
- [ ] âœ… Log de incidencias y resoluciones
- [ ] âœ… DocumentaciÃ³n de usuario actualizada
- [ ] âœ… Acta de aceptaciÃ³n firmada

---

## ğŸ“ LECCIONES APRENDIDAS Y MEJORA CONTINUA

**Post-mortem (Fin de Semana 6):**

ReuniÃ³n de 2 horas para documentar:
- Â¿QuÃ© funcionÃ³ bien?
- Â¿QuÃ© se puede mejorar?
- Â¿QuÃ© sorpresas surgieron?
- Â¿Ajustes al plan para futuros clientes?

**Documento:** Lecciones_Aprendidas_Migracion_[Cliente].md

---

## âœï¸ APROBACIONES

| Rol | Nombre | Firma | Fecha |
|-----|--------|-------|-------|
| **LÃ­der TÃ©cnico** | Edwin MarÃ­n | __________ | ___/___/___ |
| **Cliente** | [Nombre] | __________ | ___/___/___ |
| **Gerente General** | [Nombre] | __________ | ___/___/___ |

---

**Fin del Plan de MigraciÃ³n de Datos**  
**VersiÃ³n:** 1.0  
**Ãšltima actualizaciÃ³n:** 2 de febrero de 2026

---

## ğŸ”— DOCUMENTOS RELACIONADOS

- [02.1_Analisis_Problema.md](./02.1_Analisis_Problema.md)
- [02.2_Requerimientos_Funcionales.md](./02.2_Requerimientos_Funcionales.md)
- [02.4_Diagramas_Sistema.md](./02.4_Diagramas_Sistema.md)
- [../01_EJECUTIVA/01.1_Resumen_Ejecutivo.md](../01_EJECUTIVA/01.1_Resumen_Ejecutivo.md)
- [../04_OPERATIVA/04.1_Manual_Usuario.md](../04_OPERATIVA/04.1_Manual_Usuario.md)
